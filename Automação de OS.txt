from selenium import webdriver
from selenium.webdriver.common.keys import Keys
from selenium.webdriver.common.by import By
import pyautogui
import pyperclip


# Abertura do navegador direto no SKOS
navegador = webdriver.Chrome()
navegador.get('https://sfox.net.br/app/sempreOS/#/')


# Variavel de loguin do SKOS
login_sk = 'daniellomba'

# Senha do SKOS
passworld_sk = '123456'


# Variavel do menu
option = input("""
----------Automatizador de O.S----------
(1) Problema com CTO (1)    
(2) Atendiemtno ao Técnico (2)
(3) Atendimento ao Cliente (3)
(4) Indisponibilidade de Host (4)
(5) Fechar Programa (5)

Digite a opção que deseja:

""")


if option == '1':

    # Variavel da situação da CTO
    option_problem = input(
    """
    ----------Sutaução da CTO----------

    1 - CTO com sinal divergente
    2 - CTO danificada
    3 - CTO com inseto

    Digite a opção que deseja: 
    """)

    if option_problem == '1':
        option_problem = "CTO com sinal Divergente"

    elif option_problem == '2':
        option_problem = "CTO danificada"

    elif option_problem == '3':
        option_problem = "CTO com inseto"


    # Variavel da origem do atenidmento (vai ser usado pra escolher qual caminho XPATH ultilizar para abrir a OS no Sankhya)
    org_atendimento = input("""
    ----------Origem do atendimento----------

    1 - Telefonico
    2 - Chat Online

    """)


    
    # Variavel do nome e telefone de técnico 
    name_tec =str(input('Digite o nome e telefone do Técnico que identificou o incidente'))

    # Variavel da identificação da CTO
    cto_id = str(input('Digite a identificação da CTO'))

    # Variavel do sinal da CTO
    cto_signal = str(input('Digite o sinal encontrado pelo técnico na CTO'))
    

    # Variavel do cliente 
    client = str(input('digite o cliente base'))

    # Variavel do link da CTO (define qual URL o navegador acessará)
    cto_location = str(input('Digite o link da localização da CTO'))
    
    # Busca do endereço de forma automática
    navegador.get(cto_location)
    cto_address = navegador.find_element(By.XPATH, '//*[@id="QA0Szd"]/div/div/div[1]/div[2]/div/div[1]/div/div/div[7]/div/div[1]/span[3]').get_attribute('innerHTML')
     

    

    # Enviar para fila do ROT CTO sem sinal
    
    # Código do SKOS para cada cidade/POP
    igarape_code = 45456
    martinho_campos_code = 45460
    
    # Variavel que monta a OS
    os = f''' 
    Chamado aberto para verificação da {option_problem}

    -Técnico que identificou o problema: {name_tec}
    - Identificação da CTO: {cto_id}
    - Sinal: {cto_signal}
    - Endereço: {cto_address}
    - Localização: {cto_location}
    - Referência: S/ REFERÊNCIA.
    - SINAL da CTO anterior: Sem informação.
    - Foto da identificação da caixa: Anexo.
    - Foto do sinal da CTO: Anexo.

    CLIENTE BASE:
    {client}'''
    
    # Autenticação Pessoal Minha , Deve ser tratado  


    # Automação Web Selenuim   
    

                # Selenium Part 1 - Logar no SKOS


    
    # Caminho para inserir o login
    navegador.find_element(By.XPATH, '/html/body/wok-root/nz-layout/div/app-login/nz-layout/div[2]/div[2]/div/form/nz-form-item[1]/nz-form-control/div/div/nz-input-group/input').send_keys(login_sk)
    # Caminho para inserir a senha
    navegador.find_element(By.XPATH, '/html/body/wok-root/nz-layout/div/app-login/nz-layout/div[2]/div[2]/div/form/nz-form-item[2]/nz-form-control/div/div/nz-input-group/input').send_keys(passworld_sk)
    # Clique para entrar(Embarcar na missão)
    navegador.find_element(By.XPATH, '/html/body/wok-root/nz-layout/div/app-login/nz-layout/div[2]/div[2]/div/form/button/span').click()



                #Selenium Parte 2 - Achar o POP e preencher os campos

    # Clique no botão de menu 
    navegador.find_element(By.XPATH, '/html/body/wok-root/nz-layout/div/app-window/nz-header/button/i/svg/path').click()
    navegador.find_element(By.XPATH, '//*[@id="cdk-overlay-1"]/div/ul/div/div/li[1]/span').click()
    navegador.find_element(By.XPATH, '/html/body/wok-root/nz-layout/div/app-window/nz-header/nz-tabset/div/div/div[3]/div/app-pop/nz-layout/nz-sider/div/div[2]/div[2]/div/div/div[1]/label/span[1]/input').click()
    navegador.find_element(By.XPATH, '/html/body/wok-root/nz-layout/div/app-window/nz-header/nz-tabset/div/div/div[3]/div/app-pop/nz-layout/nz-sider/div/div[2]/div[2]/div/div/div[2]/button/i/svg').click()
    navegador.find_element(By.XPATH, '/html/body/wok-root/nz-layout/div/app-window/nz-header/nz-tabset/div/div/div[3]/div/app-pop/nz-layout/nz-sider/div/div[2]/div[2]/div[2]/nz-form-item/nz-form-control/div/div/div/div[1]/nz-select/nz-select-top-control/nz-select-search/input').send_keys(igarape_code)
    navegador.find_element(By.XPATH, '/html/body/wok-root/nz-layout/div/app-window/nz-header/nz-tabset/div/div/div[3]/div/app-pop/nz-layout/nz-sider/div/div[2]/div[2]/div[2]/nz-form-item/nz-form-control/div/div/div/div[1]/nz-select/nz-select-top-control/nz-select-search/input').send_keys(keys.ENTER)
    navegador.find_element(By.XPATH, '//*[@id="cdk-overlay-2"]/nz-option-container/div/cdk-virtual-scroll-viewport/div[1]/nz-option-item/div').click()
    navegador.find_element(By.XPATH, '/html/body/wok-root/nz-layout/div/app-window/nz-header/nz-tabset/div/div/div[3]/div/app-pop/nz-layout/nz-sider/div/div[2]/div[2]/div[2]/nz-form-item/nz-form-control/div/div/div/div[2]/button/i/svg').click()
    if org_atendimento == '1':
        navegador.find_element(By.XPATH, '//*[@id="cdk-overlay-4"]/nz-option-container/div/cdk-virtual-scroll-viewport/div[1]/nz-option-item[4]/div').click()
    elif org_atendimento == '2':
        navegador.find_element(By.XPATH, '//*[@id="cdk-overlay-4"]/nz-option-container/div/cdk-virtual-scroll-viewport/div[1]/nz-option-item[11]/div').click()
    
    navegador.find_element(By.XPAYH, '//*[@id="cdk-overlay-6"]/nz-option-container/div/cdk-virtual-scroll-viewport/div[1]/nz-option-item[8]/div').click()
    
    if option_problem == '1' or '2':
        navegador.find_element(By.XPAYH, '//*[@id="cdk-overlay-7"]/nz-option-container/div/cdk-virtual-scroll-viewport/div[1]/nz-option-item[3]/div').click
    elif option_problem == '3':
        navegador.find_element(By.XPAYH, '//*[@id="cdk-overlay-7"]/nz-option-container/div/cdk-virtual-scroll-viewport/div[1]/nz-option-item[2]/div').click
        
    navegador.find_element(By.XPATH, '//*[@id="cdk-overlay-8"]/nz-option-container/div/cdk-virtual-scroll-viewport/div[1]/nz-option-item[1]/div').click
    navegador.find_element(By.XPATH, '//*[@id="cdk-overlay-8"]/nz-option-container/div/cdk-virtual-scroll-viewport/div[1]/nz-option-item[1]/div').click
    navegador.find_element(By.XPATH, '//*[@id="cdk-overlay-3"]/nz-modal-container/div/div/div[1]/app-pop-generate-os/app-modal/div[2]/form/nz-form-item[3]/nz-form-control/div/div/nz-textarea-count/textarea').send_keys(os)
        
    

    # Colocar na fila aguardando terceiro 

    # Postar no Bitrix24




    #deverá ser pensado como resolver a questão dos anexos

    


    
    
# ATENDIEMNTO AO TECNICO           
elif option == 2:
    
    navegador.get('http://skw.sfox.com.br:8080/mge/login.jsp?expired=true')
    
    name_tec = input(str('Nome e telefone do técnico'))
    client = input(str('Cleinte que o técnico está atendendo'))
    problem = str(input('''
    Escolha um problema ou digite um específico

    1 - Problemas com ONU 
    2 - Problemas com Roteador
    3 - Cliente não passa banda contratada
    4 - Troca de senha Wifi

    Ou Digite os problema especifico
    '''))

    if  problem == '1':
      problem = "Problemas com ONU"
      
    elif problem == '2':
      problem = 'Problemas com Roteador'

    elif problem == '3':
      problem = 'Cliente não passa banda contratadar'

    elif problem == '4':
      problem = 'Troca de senha Wifi'

    else:
      problem = problem

    action = str(input(''' 
    Escreva o procediemtno realizado:
    '''))

    finalization = str(input('''
    
    Escolha se a O.S deverá ser finalizada

    1 - Caso deseje já finalizar a O.S
    2 - Caso deseje deixa-la em aberto e finalizar depois
    
    '''))

    

    print(f''' 
    
    Técnico: {name_tec}
    Cliente: {client}

    Problema: {problem}

    Resolução: {action}
    
    ''')

    # Automatizar para postar no Sankhya
    
    # Automatizar para postar no Sankhya

    # Input do login no Sankhya
    navegador.find_element(By.XPATH, '//*[@id="login"]').send_keys(login_sk)
    navegador.find_element(By.XPATH, '//*[@id="password"]').send_keys(passworld_sk)
    navegador.find_element(By.XPATH, '/html/body/div[1]/div[2]/div[2]/div[1]/div/button').click()
    

    # Devolver o numero da OS****


    #45456

    Abertura de OS pelo Sankhya 

    # Passo 1 - Abrir o site do Sankhya

    # Passo 2 - Pesquisar por Lançamento de OS + ENTER

    # Passo 3 - Mudar "Campo" para "codigo do parceiro"

    # Passo 4 - Definir "Início" com o código da cidade

    # Passo 5 - Pesquisar

    # Passo 6 - Definir "Produto" como ordem de serviço

    # Passo 7 - Definir "Serviço Previsto" como "Atendimento a cliente ext..."

    # Passo 8 - Escolher executante

    # Passo 9 - inputar a OS

    # Passo 10 - Definir "Classificação" como "Conformidade"

    # Passo 11 - Definir "Motivo" (para teste usar "confi de equip..")

    # Passo 12 - Definir "Status sub OS" como "pendente"
    
    

    # Devolver o numero da OS
    
    
elif option == '4':
    
    #CNPJ Oi 05423963016387
    
    client_cnpj = input('''
    Informe o CNPJ do cliente 
    
    ''')
    
    ssituation_client = input('''
    Qual a trat
    ''')
    
    
    # Fazer a integração com HUBSOFT
    
    # Passo 1 - Entrar no hubsoft
    
    # Passo 2 - Pesquisar o cliente
    
    # Passo 3 - Abrir o protocolo    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    